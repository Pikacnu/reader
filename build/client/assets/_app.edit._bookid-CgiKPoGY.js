import{r as l,j as t}from"./jsx-runtime-C2JdrU5W.js";import{B as C}from"./bookinfo-XVuh1142.js";import{u as S,L as b}from"./components-D0pOR1-x.js";import"./single-fetch-BCsd51Q2.js";const $=({data:e})=>{var n;return[{title:`Laganto - Edit - ${((n=e==null?void 0:e.bookdata)==null?void 0:n.title)||""}`}]};function A(){var x;const{bookdata:e,userdata:n,chapters:r}=S(),[o,f]=l.useState(e==null?void 0:e.title),[c,p]=l.useState(e==null?void 0:e.cover),a=l.useRef(null),[i,v]=l.useState((x=e==null?void 0:e.tags)==null?void 0:x.join(",")),[d,j]=l.useState(e==null?void 0:e.published),[u,g]=l.useState(e==null?void 0:e.allow_comments),[m,w]=l.useState(e==null?void 0:e.description);return t.jsxs("div",{children:[t.jsx("div",{className:"bg-green-200 absolute",hidden:!0,children:t.jsx("p",{className:"bg-red-200"})}),e?t.jsxs("div",{className:"flex flex-row w-full",children:[t.jsxs("div",{className:"flex flex-col w-1/3 item-center",children:[[{nane:"title",default:o,setvalue:f},{nane:"cover",default:c,setvalue:s=>{if(p(s),s.match(/^(http|https):\/\/[a-zA-Z0-9-\.]+\.[a-zA-Z]{2,4}/)){a.current="outline-green-300";return}a.current="outline-red-300"}},{nane:"tags",default:i,setvalue:v},{nane:"description",default:m,setvalue:w}].map((s,h)=>t.jsxs("div",{className:"flex flex-col *:w-full *:outline-1  *:m-2",children:[t.jsx("label",{children:s.nane}),t.jsx("input",{className:`bg-gray-200 p-2 rounded-lg ${s.nane==="cover"?a.current:"outline-teal-300"}`,type:"text",value:s.default||"",onChange:N=>{s.setvalue(N.currentTarget.value)}}),t.jsx("hr",{})]},h)),t.jsxs("div",{className:"*:m-2",children:[t.jsxs("div",{className:"grid md:grid-cols-2",children:[t.jsx("button",{className:`bg-${d?"green":"red"}-200`,onClick:()=>j(s=>!s),children:d?"Published":"Unpublished"}),t.jsx("button",{className:`bg-${u?"green":"red"}-200`,onClick:()=>g(s=>!s),children:u?"Allow Comment":"Disallow Comment"})]}),t.jsxs("div",{className:"grid md:grid-cols-2 *:text-center",children:[t.jsx("button",{onClick:()=>{fetch("/api/book/save",{method:"POST",headers:{"Content-Type":"application/json"},redirect:"follow",body:JSON.stringify({id:e.id,title:o,cover:c,tags:i,description:m,author_id:n.id,published:d,allow_comments:u})}).then(s=>{if(s.redirected){window.location.href=s.url;return}s.json().then(h=>{h.success===!0&&alert("Saved")})})},children:"Save BookInfo"}),t.jsx(b,{to:`/editor/${e.id}`,children:"Edit Chapter"})]})]})]}),t.jsx("div",{className:"w-2/3",children:t.jsx(C,{bookinfo:{title:o||"",cover:c||"",tags:(i==null?void 0:i.split(","))||[],description:m||"",author:n.displayName||"",chapters:(r==null?void 0:r.map(s=>({title:s.title||"",link:""})))||[]}})})]}):t.jsx("div",{children:"Book not found"})]})}export{A as default,$ as meta};
